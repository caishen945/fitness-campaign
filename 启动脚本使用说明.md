# FitChallenge 启动脚本使用说明

## 📋 脚本概览

本项目提供了多个启动脚本，方便您快速启动和管理FitChallenge的所有服务。

## 🚀 启动脚本

### 1. 一键启动所有服务

#### Windows批处理版本
```bash
start-all-servers.bat
```

#### 改进版（推荐）
```bash
start-all-servers-improved.bat
```

#### PowerShell版本
```powershell
.\start-all-servers.ps1
```

**功能特点:**
- ✅ 自动检查Node.js环境
- ✅ 自动启动MySQL和Redis服务
- ✅ 检查并释放端口占用
- ✅ 自动安装依赖包
- ✅ 启动所有服务（后端、前端、管理后台）
- ✅ 自动检查服务状态
- ✅ 提供访问链接
- ✅ 改进版：避免终端窗口被意外关闭

### 2. 快速启动菜单

```bash
quick-start.bat
```

**功能特点:**
- 🎯 交互式菜单选择
- 🚀 可选择启动单个服务
- 🧪 内置系统测试功能
- 📱 提供访问地址

### 3. 停止所有服务

#### Windows批处理版本
```bash
stop-all-servers.bat
```

#### PowerShell版本
```powershell
.\stop-all-servers.ps1
```

**功能特点:**
- 🛑 停止所有Node.js进程
- 🔌 释放端口占用
- 🗄️ 停止数据库服务

## 📱 服务端口配置

| 服务 | 端口 | 访问地址 | 说明 |
|------|------|----------|------|
| 后端API | 3000 | http://localhost:3000 | 主要API服务 |
| 后端API(备用) | 3002 | http://localhost:3002 | 备用API服务 |
| 前端应用 | 8080 | http://localhost:8080 | 用户界面 |
| 管理后台 | 8081 | http://localhost:8081 | 管理员界面 |

## 🔧 环境要求

### 必需软件
- **Node.js 16+** - JavaScript运行环境
- **WSL 2** - Windows Subsystem for Linux
- **Ubuntu 22.04** - Linux发行版

### 数据库服务
- **MySQL 8.0+** - 关系型数据库
- **Redis 6.0+** - 缓存数据库

## 📋 使用步骤

### 首次使用
1. **确保环境准备就绪**
   - 安装Node.js
   - 配置WSL 2和Ubuntu
   - 安装MySQL和Redis

2. **运行一键启动脚本**
   ```bash
   # 推荐使用改进版（避免终端窗口被关闭）
   start-all-servers-improved.bat
   
   # 或使用原版
   start-all-servers.bat
   ```

3. **等待服务启动**
   - 脚本会自动检查环境
   - 安装必要的依赖
   - 启动所有服务

4. **访问应用**
   - 前端应用: http://localhost:8080
   - 管理后台: http://localhost:8081
   - 后端API: http://localhost:3000

### 日常使用
1. **启动服务**
   ```bash
   quick-start.bat
   ```
   选择相应的选项启动服务

2. **停止服务**
   ```bash
   stop-all-servers.bat
   ```

## 🧪 测试功能

### 系统测试
```bash
cd backend
node test-complete-system.js
```

**测试内容:**
- ✅ 用户认证系统
- ✅ 钱包功能
- ✅ 签到系统
- ✅ 成就系统
- ✅ VIP等级系统
- ✅ 数据库连接
- ✅ Redis缓存

### 健康检查
- 后端健康检查: http://localhost:3000/api/health
- 系统测试: http://localhost:3000/api/test

## 🔍 故障排除

### 常见问题

#### 1. 端口被占用
**症状:** 启动失败，提示端口被占用
**解决方案:**
```bash
# 查看端口占用
netstat -ano | findstr :3000
netstat -ano | findstr :3002
netstat -ano | findstr :8080
netstat -ano | findstr :8081

# 终止占用进程
taskkill /f /pid <进程ID>
```

#### 2. 数据库连接失败
**症状:** 后端启动失败，数据库连接错误
**解决方案:**
```bash
# 检查MySQL服务
wsl -d Ubuntu-22.04 --exec sudo systemctl status mysql

# 启动MySQL服务
wsl -d Ubuntu-22.04 --exec sudo systemctl start mysql
```

#### 3. 依赖包缺失
**症状:** 启动失败，模块未找到
**解决方案:**
```bash
# 重新安装依赖
cd backend && npm install
cd ../frontend && npm install
cd ../admin && npm install && npm run build
```

#### 4. WSL服务未启动
**症状:** 无法连接WSL服务
**解决方案:**
```bash
# 启动WSL
wsl --shutdown
wsl -d Ubuntu-22.04
```

#### 5. 启动脚本导致终端窗口被关闭
**症状:** 运行启动脚本后，所有服务终端窗口被关闭
**解决方案:**
```bash
# 使用改进版启动脚本
start-all-servers-improved.bat

# 或手动启动各个服务
quick-start.bat
```

## 📊 脚本功能对比

| 功能 | start-all-servers.bat | start-all-servers.ps1 | quick-start.bat | stop-all-servers.bat |
|------|----------------------|----------------------|-----------------|---------------------|
| 一键启动所有服务 | ✅ | ✅ | ✅ | ❌ |
| 环境检查 | ✅ | ✅ | ❌ | ❌ |
| 端口检查 | ✅ | ✅ | ❌ | ❌ |
| 依赖安装 | ✅ | ✅ | ✅ | ❌ |
| 服务状态检查 | ✅ | ✅ | ❌ | ❌ |
| 交互式菜单 | ❌ | ❌ | ✅ | ❌ |
| 停止服务 | ❌ | ❌ | ❌ | ✅ |
| 彩色输出 | ❌ | ✅ | ❌ | ❌ |

## 💡 使用建议

### 开发环境
- 使用 `quick-start.bat` 进行日常开发
- 选择启动单个服务进行调试
- 使用系统测试功能验证功能

### 生产环境
- 使用 `start-all-servers.ps1` 启动所有服务
- 使用 `stop-all-servers.ps1` 停止所有服务
- 定期运行系统测试

### 故障排除
- 优先使用PowerShell版本脚本（更好的错误处理）
- 检查日志文件获取详细错误信息
- 使用健康检查接口验证服务状态

## 🔗 相关链接

- **项目文档:** README.md
- **API文档:** API接口文档.md
- **管理后台指南:** ADMIN_GUIDE.md
- **部署报告:** DEPLOYMENT_REPORT.md

---

**提示:** 首次使用建议运行 `start-all-servers.bat` 进行完整的环境检查和启动。
