<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç®€åŒ–æµ‹è¯•é¡µé¢</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .test-section {
            background: white;
            margin: 20px 0;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .status {
            padding: 10px;
            margin: 10px 0;
            border-radius: 4px;
            font-weight: bold;
        }
        .status.loaded { background-color: #d4edda; color: #155724; }
        .status.not-loaded { background-color: #f8d7da; color: #721c24; }
        .test-btn {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            margin: 5px;
            border-radius: 4px;
            cursor: pointer;
        }
        .test-btn:hover { background: #0056b3; }
        .console {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            padding: 15px;
            margin: 20px 0;
            border-radius: 4px;
            font-family: monospace;
            max-height: 300px;
            overflow-y: auto;
        }
    </style>
</head>
<body>
    <h1>ğŸ§ª ç®€åŒ–æµ‹è¯•é¡µé¢</h1>
    <p>è¿™ä¸ªé¡µé¢ç”¨äºæµ‹è¯•æ¨¡å—åŠ è½½æ˜¯å¦æ­£å¸¸</p>

    <div class="test-section">
        <h2>ğŸ“‹ æ¨¡å—çŠ¶æ€æ£€æŸ¥</h2>
        <div id="moduleStatus"></div>
    </div>

    <div class="test-section">
        <h2>ğŸ¯ åŠŸèƒ½æµ‹è¯•</h2>
        <button class="test-btn" onclick="testBasicFunctions()">æµ‹è¯•åŸºç¡€åŠŸèƒ½</button>
        <button class="test-btn" onclick="testTelegramMock()">æµ‹è¯•Telegramæ¨¡æ‹Ÿå™¨</button>
        <button class="test-btn" onclick="testApiMock()">æµ‹è¯•APIæ¨¡æ‹Ÿå™¨</button>
        <button class="test-btn" onclick="testDeviceSimulator()">æµ‹è¯•è®¾å¤‡æ¨¡æ‹Ÿå™¨</button>
        <button class="test-btn" onclick="testLanguageTester()">æµ‹è¯•è¯­è¨€æµ‹è¯•å™¨</button>
    </div>

    <div class="test-section">
        <h2>ğŸ“ æ§åˆ¶å°è¾“å‡º</h2>
        <div id="console" class="console"></div>
        <button class="test-btn" onclick="clearConsole()">æ¸…ç©ºæ§åˆ¶å°</button>
    </div>

    <!-- è„šæœ¬åŠ è½½ -->
    <script src="telegram-mock.js"></script>
    <script src="api-mock.js"></script>
    <script src="device-simulator.js"></script>
    <script src="language-tester.js"></script>

    <script>
        // æ§åˆ¶å°è¾“å‡ºå‡½æ•°
        function log(message) {
            const console = document.getElementById('console');
            const line = document.createElement('div');
            line.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
            console.appendChild(line);
            console.scrollTop = console.scrollHeight;
        }

        function clearConsole() {
            document.getElementById('console').innerHTML = '';
        }

        // æ£€æŸ¥æ¨¡å—çŠ¶æ€
        function checkModuleStatus() {
            const modules = [
                { name: 'Telegramæ¨¡æ‹Ÿå™¨', global: 'telegramMock' },
                { name: 'APIæ¨¡æ‹Ÿå™¨', global: 'apiMock' },
                { name: 'è®¾å¤‡æ¨¡æ‹Ÿå™¨', global: 'deviceSimulator' },
                { name: 'è¯­è¨€æµ‹è¯•å™¨', global: 'languageTester' }
            ];

            const statusDiv = document.getElementById('moduleStatus');
            let statusHTML = '';

            modules.forEach(module => {
                const isLoaded = window[module.global] !== undefined;
                const statusClass = isLoaded ? 'loaded' : 'not-loaded';
                const statusText = isLoaded ? 'âœ… å·²åŠ è½½' : 'âŒ æœªåŠ è½½';
                
                statusHTML += `
                    <div class="status ${statusClass}">
                        ${module.name}: ${statusText}
                    </div>
                `;
            });

            statusDiv.innerHTML = statusHTML;
        }

        // æµ‹è¯•åŸºç¡€åŠŸèƒ½
        function testBasicFunctions() {
            log('ğŸ§ª å¼€å§‹æµ‹è¯•åŸºç¡€åŠŸèƒ½...');
            
            try {
                // æµ‹è¯•DOMæ“ä½œ
                const testDiv = document.createElement('div');
                testDiv.textContent = 'æµ‹è¯•DOMæ“ä½œ';
                document.body.appendChild(testDiv);
                document.body.removeChild(testDiv);
                log('âœ… DOMæ“ä½œæµ‹è¯•æˆåŠŸ');

                // æµ‹è¯•äº‹ä»¶ç³»ç»Ÿ
                let eventTriggered = false;
                const testEvent = new CustomEvent('test-event');
                document.addEventListener('test-event', () => { eventTriggered = true; });
                document.dispatchEvent(testEvent);
                log(eventTriggered ? 'âœ… äº‹ä»¶ç³»ç»Ÿæµ‹è¯•æˆåŠŸ' : 'âŒ äº‹ä»¶ç³»ç»Ÿæµ‹è¯•å¤±è´¥');

                // æµ‹è¯•å¼‚æ­¥æ“ä½œ
                setTimeout(() => {
                    log('âœ… å¼‚æ­¥æ“ä½œæµ‹è¯•æˆåŠŸ');
                }, 100);

            } catch (error) {
                log(`âŒ åŸºç¡€åŠŸèƒ½æµ‹è¯•å¤±è´¥: ${error.message}`);
            }
        }

        // æµ‹è¯•Telegramæ¨¡æ‹Ÿå™¨
        function testTelegramMock() {
            log('ğŸ§ª å¼€å§‹æµ‹è¯•Telegramæ¨¡æ‹Ÿå™¨...');
            
            if (window.telegramMock) {
                try {
                    const status = window.telegramMock.getStatus();
                    log(`âœ… Telegramæ¨¡æ‹Ÿå™¨çŠ¶æ€: ${JSON.stringify(status)}`);
                    
                    // æµ‹è¯•æ¨¡æ‹Ÿæˆæƒ
                    window.telegramMock.simulateAuth();
                    log('âœ… Telegramæ¨¡æ‹Ÿæˆæƒæµ‹è¯•æˆåŠŸ');
                    
                } catch (error) {
                    log(`âŒ Telegramæ¨¡æ‹Ÿå™¨æµ‹è¯•å¤±è´¥: ${error.message}`);
                }
            } else {
                log('âŒ Telegramæ¨¡æ‹Ÿå™¨æœªåŠ è½½');
            }
        }

        // æµ‹è¯•APIæ¨¡æ‹Ÿå™¨
        function testApiMock() {
            log('ğŸ§ª å¼€å§‹æµ‹è¯•APIæ¨¡æ‹Ÿå™¨...');
            
            if (window.apiMock) {
                try {
                    const status = window.apiMock.getStatus();
                    log(`âœ… APIæ¨¡æ‹Ÿå™¨çŠ¶æ€: ${JSON.stringify(status)}`);
                    
                    // æµ‹è¯•APIè¯·æ±‚
                    window.apiMock.request('/api/test', 'GET').then(response => {
                        log(`âœ… APIè¯·æ±‚æµ‹è¯•æˆåŠŸ: ${JSON.stringify(response)}`);
                    }).catch(error => {
                        log(`âŒ APIè¯·æ±‚æµ‹è¯•å¤±è´¥: ${error.message}`);
                    });
                    
                } catch (error) {
                    log(`âŒ APIæ¨¡æ‹Ÿå™¨æµ‹è¯•å¤±è´¥: ${error.message}`);
                }
            } else {
                log('âŒ APIæ¨¡æ‹Ÿå™¨æœªåŠ è½½');
            }
        }

        // æµ‹è¯•è®¾å¤‡æ¨¡æ‹Ÿå™¨
        function testDeviceSimulator() {
            log('ğŸ§ª å¼€å§‹æµ‹è¯•è®¾å¤‡æ¨¡æ‹Ÿå™¨...');
            
            if (window.deviceSimulator) {
                try {
                    const status = window.deviceSimulator.getStatus();
                    log(`âœ… è®¾å¤‡æ¨¡æ‹Ÿå™¨çŠ¶æ€: ${JSON.stringify(status)}`);
                    
                    // æµ‹è¯•è®¾å¤‡åˆ‡æ¢
                    window.deviceSimulator.switchDevice('mobile');
                    log('âœ… è®¾å¤‡åˆ‡æ¢æµ‹è¯•æˆåŠŸ');
                    
                } catch (error) {
                    log(`âŒ è®¾å¤‡æ¨¡æ‹Ÿå™¨æµ‹è¯•å¤±è´¥: ${error.message}`);
                }
            } else {
                log('âŒ è®¾å¤‡æ¨¡æ‹Ÿå™¨æœªåŠ è½½');
            }
        }

        // æµ‹è¯•è¯­è¨€æµ‹è¯•å™¨
        function testLanguageTester() {
            log('ğŸ§ª å¼€å§‹æµ‹è¯•è¯­è¨€æµ‹è¯•å™¨...');
            
            if (window.languageTester) {
                try {
                    const status = window.languageTester.getStatus();
                    log(`âœ… è¯­è¨€æµ‹è¯•å™¨çŠ¶æ€: ${JSON.stringify(status)}`);
                    
                    // æµ‹è¯•è¯­è¨€åˆ‡æ¢
                    window.languageTester.switchLanguage('zh-CN');
                    log('âœ… è¯­è¨€åˆ‡æ¢æµ‹è¯•æˆåŠŸ');
                    
                } catch (error) {
                    log(`âŒ è¯­è¨€æµ‹è¯•å™¨æµ‹è¯•å¤±è´¥: ${error.message}`);
                }
            } else {
                log('âŒ è¯­è¨€æµ‹è¯•å™¨æœªåŠ è½½');
            }
        }

        // é¡µé¢åŠ è½½å®Œæˆåæ£€æŸ¥æ¨¡å—çŠ¶æ€
        document.addEventListener('DOMContentLoaded', () => {
            log('ğŸš€ é¡µé¢åŠ è½½å®Œæˆï¼Œå¼€å§‹æ£€æŸ¥æ¨¡å—çŠ¶æ€...');
            
            // å»¶è¿Ÿæ£€æŸ¥ï¼Œç¡®ä¿è„šæœ¬æœ‰æ—¶é—´åŠ è½½
            setTimeout(() => {
                checkModuleStatus();
                log('ğŸ“‹ æ¨¡å—çŠ¶æ€æ£€æŸ¥å®Œæˆ');
            }, 500);
        });

        // ç›‘å¬æ¨¡å—åŠ è½½äº‹ä»¶
        window.addEventListener('load', () => {
            log('ğŸ“± æ‰€æœ‰èµ„æºåŠ è½½å®Œæˆ');
            checkModuleStatus();
        });
    </script>
</body>
</html>
