<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å·¥ä½œæµ‹è¯•é¡µé¢</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; background: #f5f5f5; }
        .container { max-width: 800px; margin: 0 auto; background: white; padding: 20px; border-radius: 10px; }
        .test-section { margin: 20px 0; padding: 15px; border: 1px solid #ddd; border-radius: 5px; }
        button { padding: 10px 15px; margin: 5px; border: none; border-radius: 5px; background: #007bff; color: white; cursor: pointer; }
        button:hover { background: #0056b3; }
        .result { margin: 10px 0; padding: 10px; border-radius: 3px; font-family: monospace; }
        .success { background: #d4edda; color: #155724; }
        .error { background: #f8d7da; color: #721c24; }
        .info { background: #d1ecf1; color: #0c5460; }
        .console { background: #f8f9fa; padding: 15px; border-radius: 5px; max-height: 400px; overflow-y: auto; }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ§ª å·¥ä½œæµ‹è¯•é¡µé¢</h1>
        <p>è¿™ä¸ªé¡µé¢ç”¨äºæµ‹è¯•åŸºæœ¬åŠŸèƒ½ï¼Œè§£å†³å¤æ‚æµ‹è¯•ç¯å¢ƒçš„æ— å“åº”é—®é¢˜ã€‚</p>
        
        <div class="test-section">
            <h3>ğŸ”§ åŸºç¡€åŠŸèƒ½æµ‹è¯•</h3>
            <button onclick="testBasic()">æµ‹è¯•åŸºç¡€åŠŸèƒ½</button>
            <button onclick="testDOM()">æµ‹è¯•DOMæ“ä½œ</button>
            <button onclick="testEvents()">æµ‹è¯•äº‹ä»¶ç³»ç»Ÿ</button>
        </div>
        
        <div class="test-section">
            <h3>ğŸ“± æ¨¡å—æµ‹è¯•</h3>
            <button onclick="testModules()">æµ‹è¯•æ¨¡å—åŠ è½½</button>
            <button onclick="testTelegram()">æµ‹è¯•Telegram</button>
            <button onclick="testAPI()">æµ‹è¯•API</button>
        </div>
        
        <div class="test-section">
            <h3>ğŸ¯ ç»¼åˆæµ‹è¯•</h3>
            <button onclick="runAll()">è¿è¡Œæ‰€æœ‰æµ‹è¯•</button>
            <button onclick="clearResults()">æ¸…ç©ºç»“æœ</button>
        </div>
        
        <div class="test-section">
            <h3>ğŸ“ æµ‹è¯•ç»“æœ</h3>
            <div id="results" class="console">
                <div class="result info">ğŸš€ æµ‹è¯•é¡µé¢å·²åŠ è½½ï¼Œç­‰å¾…æµ‹è¯•...</div>
            </div>
        </div>
    </div>

    <script>
        function log(message, type = 'info') {
            const timestamp = new Date().toLocaleTimeString();
            const result = document.createElement('div');
            result.className = `result ${type}`;
            result.textContent = `[${timestamp}] ${message}`;
            
            const container = document.getElementById('results');
            container.appendChild(result);
            container.scrollTop = container.scrollHeight;
            
            console.log(`[${type.toUpperCase()}] ${message}`);
        }
        
        function clearResults() {
            document.getElementById('results').innerHTML = '';
            log('ğŸ§¹ æµ‹è¯•ç»“æœå·²æ¸…ç©º', 'info');
        }
        
        function testBasic() {
            log('ğŸ§ª å¼€å§‹æµ‹è¯•åŸºç¡€åŠŸèƒ½...', 'info');
            
            try {
                // æµ‹è¯•åŸºæœ¬JavaScriptåŠŸèƒ½
                const testArray = [1, 2, 3, 4, 5];
                const doubled = testArray.map(x => x * 2);
                if (doubled.join(',') === '2,4,6,8,10') {
                    log('âœ… æ•°ç»„æ“ä½œæµ‹è¯•æˆåŠŸ', 'success');
                } else {
                    log('âŒ æ•°ç»„æ“ä½œæµ‹è¯•å¤±è´¥', 'error');
                }
                
                // æµ‹è¯•JSONæ“ä½œ
                const testObj = { name: 'test', value: 123 };
                const jsonStr = JSON.stringify(testObj);
                const parsedObj = JSON.parse(jsonStr);
                if (parsedObj.name === 'test' && parsedObj.value === 123) {
                    log('âœ… JSONæ“ä½œæµ‹è¯•æˆåŠŸ', 'success');
                } else {
                    log('âŒ JSONæ“ä½œæµ‹è¯•å¤±è´¥', 'error');
                }
                
                log('âœ… åŸºç¡€åŠŸèƒ½æµ‹è¯•å®Œæˆ', 'success');
                
            } catch (error) {
                log(`âŒ åŸºç¡€åŠŸèƒ½æµ‹è¯•å¤±è´¥: ${error.message}`, 'error');
            }
        }
        
        function testDOM() {
            log('ğŸ§ª å¼€å§‹æµ‹è¯•DOMæ“ä½œ...', 'info');
            
            try {
                // æµ‹è¯•DOMåˆ›å»º
                const testElement = document.createElement('div');
                testElement.textContent = 'æµ‹è¯•å…ƒç´ ';
                testElement.className = 'test-dom-element';
                document.body.appendChild(testElement);
                
                // æµ‹è¯•DOMæŸ¥è¯¢
                const foundElement = document.querySelector('.test-dom-element');
                if (foundElement && foundElement.textContent === 'æµ‹è¯•å…ƒç´ ') {
                    log('âœ… DOMåˆ›å»ºå’ŒæŸ¥è¯¢æµ‹è¯•æˆåŠŸ', 'success');
                } else {
                    log('âŒ DOMåˆ›å»ºå’ŒæŸ¥è¯¢æµ‹è¯•å¤±è´¥', 'error');
                }
                
                // æ¸…ç†æµ‹è¯•å…ƒç´ 
                document.body.removeChild(testElement);
                log('âœ… DOMæ¸…ç†æµ‹è¯•æˆåŠŸ', 'success');
                
                log('âœ… DOMæ“ä½œæµ‹è¯•å®Œæˆ', 'success');
                
            } catch (error) {
                log(`âŒ DOMæ“ä½œæµ‹è¯•å¤±è´¥: ${error.message}`, 'error');
            }
        }
        
        function testEvents() {
            log('ğŸ§ª å¼€å§‹æµ‹è¯•äº‹ä»¶ç³»ç»Ÿ...', 'info');
            
            try {
                let eventTriggered = false;
                
                // åˆ›å»ºæµ‹è¯•æŒ‰é’®
                const testButton = document.createElement('button');
                testButton.textContent = 'æµ‹è¯•äº‹ä»¶æŒ‰é’®';
                testButton.style.position = 'absolute';
                testButton.style.left = '-9999px';
                document.body.appendChild(testButton);
                
                // æ·»åŠ äº‹ä»¶ç›‘å¬å™¨
                testButton.addEventListener('click', () => {
                    eventTriggered = true;
                    log('âœ… äº‹ä»¶ç›‘å¬å™¨è¢«è§¦å‘', 'success');
                });
                
                // è§¦å‘äº‹ä»¶
                testButton.click();
                
                // ç­‰å¾…äº‹ä»¶å¤„ç†
                setTimeout(() => {
                    if (eventTriggered) {
                        log('âœ… äº‹ä»¶ç³»ç»Ÿæµ‹è¯•æˆåŠŸ', 'success');
                    } else {
                        log('âŒ äº‹ä»¶ç³»ç»Ÿæµ‹è¯•å¤±è´¥', 'error');
                    }
                    
                    // æ¸…ç†
                    document.body.removeChild(testButton);
                }, 100);
                
            } catch (error) {
                log(`âŒ äº‹ä»¶ç³»ç»Ÿæµ‹è¯•å¤±è´¥: ${error.message}`, 'error');
            }
        }
        
        function testModules() {
            log('ğŸ§ª å¼€å§‹æµ‹è¯•æ¨¡å—åŠ è½½...', 'info');
            
            const modules = [
                { name: 'Telegramæ¨¡æ‹Ÿå™¨', global: 'telegramMock' },
                { name: 'APIæ¨¡æ‹Ÿå™¨', global: 'apiMock' },
                { name: 'è®¾å¤‡æ¨¡æ‹Ÿå™¨', global: 'deviceSimulator' },
                { name: 'è¯­è¨€æµ‹è¯•å™¨', global: 'languageTester' }
            ];
            
            modules.forEach(module => {
                if (window[module.global]) {
                    log(`âœ… ${module.name} å·²åŠ è½½`, 'success');
                } else {
                    log(`âŒ ${module.name} æœªåŠ è½½`, 'error');
                }
            });
            
            log('âœ… æ¨¡å—åŠ è½½æµ‹è¯•å®Œæˆ', 'success');
        }
        
        function testTelegram() {
            log('ğŸ§ª å¼€å§‹æµ‹è¯•TelegramåŠŸèƒ½...', 'info');
            
            if (window.telegramMock) {
                try {
                    const status = window.telegramMock.getStatus();
                    log(`âœ… Telegramæ¨¡æ‹Ÿå™¨çŠ¶æ€: ${JSON.stringify(status)}`, 'success');
                    
                    // æµ‹è¯•æ¨¡æ‹Ÿè®¤è¯
                    window.telegramMock.simulateAuth();
                    log('âœ… Telegramè®¤è¯æ¨¡æ‹ŸæˆåŠŸ', 'success');
                    
                } catch (error) {
                    log(`âŒ Telegramæµ‹è¯•å¤±è´¥: ${error.message}`, 'error');
                }
            } else {
                log('âŒ Telegramæ¨¡æ‹Ÿå™¨æœªåŠ è½½', 'error');
            }
        }
        
        function testAPI() {
            log('ğŸ§ª å¼€å§‹æµ‹è¯•APIåŠŸèƒ½...', 'info');
            
            if (window.apiMock) {
                try {
                    const status = window.apiMock.getStatus();
                    log(`âœ… APIæ¨¡æ‹Ÿå™¨çŠ¶æ€: ${JSON.stringify(status)}`, 'success');
                    
                    // æµ‹è¯•APIè¯·æ±‚
                    window.apiMock.request('/api/test', 'GET').then(response => {
                        log('âœ… APIè¯·æ±‚æµ‹è¯•æˆåŠŸ', 'success');
                    }).catch(error => {
                        log(`âŒ APIè¯·æ±‚æµ‹è¯•å¤±è´¥: ${error.message}`, 'error');
                    });
                    
                } catch (error) {
                    log(`âŒ APIæµ‹è¯•å¤±è´¥: ${error.message}`, 'error');
                }
            } else {
                log('âŒ APIæ¨¡æ‹Ÿå™¨æœªåŠ è½½', 'error');
            }
        }
        
        function runAll() {
            log('ğŸ¯ å¼€å§‹è¿è¡Œæ‰€æœ‰æµ‹è¯•...', 'info');
            
            setTimeout(() => testBasic(), 100);
            setTimeout(() => testDOM(), 200);
            setTimeout(() => testEvents(), 300);
            setTimeout(() => testModules(), 400);
            setTimeout(() => testTelegram(), 500);
            setTimeout(() => testAPI(), 600);
            
            log('âœ… æ‰€æœ‰æµ‹è¯•å·²å¯åŠ¨', 'success');
        }
        
        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', () => {
            log('ğŸš€ å·¥ä½œæµ‹è¯•é¡µé¢å·²åŠ è½½', 'success');
        });
        
        console.log('ğŸ“± å·¥ä½œæµ‹è¯•é¡µé¢å·²åˆå§‹åŒ–');
    </script>
</body>
</html>
